 <!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö–æ—à–∏–∫ ‚Äî KRIPL</title>

<!-- Font Awesome –¥–ª—è —ñ–∫–æ–Ω–æ–∫ —Å–æ—Ü–º–µ—Ä–µ–∂ -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="icon" href="logo.png" type="image/png">
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f9f9f9;
  color: #111;   
   overflow-x: hidden; /* –∑–∞–±–æ—Ä–æ–Ω—è—î –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∏–π —Å–∫—Ä–æ–ª */
  width: 100%;
}
/* Header */
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 15px 30px;
  background: #fff;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  position: sticky;
  top: 0;
  z-index: 1000;
  width: 100vw;       /* –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –≤—Å—é —à–∏—Ä–∏–Ω—É –≤—ñ–∫–Ω–∞ */
  box-sizing: border-box;
}
header .btn-group { display: flex; gap: 15px; }
header .logo {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  justify-content: center;
  pointer-events: none;
}
header .logo img { width: 70px; height: auto; object-fit: contain; }
header button {
  border: 2px solid black;
  background: white;
  color: black;
  padding: 8px 16px;
  border-radius: 50px;
  cursor: pointer;
  font-weight: bold;
  font-size: 14px;
  transition: all 0.3s ease;
}
header button:hover { background: black; color: white; }

/* Main */
main {
  max-width: 1000px;
  margin: 40px auto;
  padding: 20px;
    padding-bottom: 90px;
}

.cart-container {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.cart-item {
  display: flex;
  align-items: center;
  background: #fff;
  border-radius: 12px;
  padding: 15px;
  position: relative;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
}

.cart-item img {
  width: 90px;
  height: 90px;
  object-fit: cover;
  border-radius: 8px;
  margin-right: 20px;
}

.cart-item-details {
  flex: 1;
  display: flex;
  flex-direction: column;
}
.cart-item-details p { margin: 4px 0; }

/* –ö—ñ–ª—å–∫—ñ—Å—Ç—å */
.cart-item-quantity {
  width: 60px;
  padding: 6px;
  border-radius: 50px;
  border: 1px solid #ccc;
  text-align: center;
  margin-left: 10px;
  margin-right: 10px;
  align-self: center;
}

/* –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∞–ª–∏—Ç–∏ */
.delete-btn {
  position: absolute;
  right: 15px;
  bottom: 10px;
  border: 0.5px solid black;
  background: white;
  color: black;
  padding: 7px 20px;
  border-radius: 20px;
  font-size: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
}
.delete-btn:hover { 
  background: black; 
  color: white; 
}

.total {
  text-align: right;
  font-size: 22px;
  font-weight: bold;
  margin-top: 20px;
}

.checkout-btn {
  padding: 12px 25px;
  background: black;
  color: white;
  border-radius: 50px;
  font-size: 16px;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
}
.checkout-btn:hover { background: #333; }
.checkout-btn:disabled { background: gray; cursor: not-allowed; }

/* Modal */
.modal {
  display: none;
  position: fixed;
  top:0;
  left:0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  justify-content: center;
  align-items: center;
}

.modal-content {
  background: #fff;
  border-radius: 12px;
  padding: 25px;
  width: 350px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  transform: scale(0.8);
  animation: scaleUp 0.3s forwards;
}

@keyframes scaleUp { to { transform: scale(1); } }

.close-modal {
  position: absolute;
  top: 12px;
  right: 12px;
  cursor: pointer;
  font-size: 20px;
  font-weight: bold;
  transition: transform 0.2s;
}
.close-modal:hover { transform: rotate(90deg); }

.modal-content input {
  width: 100%;
  margin-bottom: 12px;
  padding: 8px;
  border-radius: 50px;
  border: 1px solid #ccc;
}

.modal-content button {
  width: 100%;
  padding: 12px;
  border-radius: 50px;
  border: none;
  background: black;
  color: white;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s ease;
}
.modal-content button:hover { background: #333; }
.order-note {
  max-width: 1000px;
  margin: 20px auto 100px; /* 100px –≤—ñ–¥—Å—Ç—É–ø –∑–Ω–∏–∑—É, —â–æ–± –Ω–µ –ø–µ—Ä–µ–∫—Ä–∏–≤ —Ñ—É—Ç–µ—Ä */
  padding: 15px 20px;
  background: #f0f0f0;
  border-radius: 12px;
  text-align: center;
  font-size: 14px;
  color: #111;
  line-height: 1.5;
}


/* Footer */
footer {
  background: #000;
  color: #fff;
  text-align: center;
  padding: 20px 10px;
  left: 0;
  width: 100%;  
  position: fixed;  /* –∑–∞–∫—Ä—ñ–ø–ª—é—î —Ñ—É—Ç–µ—Ä */
  bottom: 0;        /* –ø—Ä–∏–∫—Ä—ñ–ø–ª—é—î –¥–æ –Ω–∏–∑—É */
  z-index: 1000; 
}

footer .social-links {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-bottom: 10px;
}

footer .social-links a {
  color: white;
  transition: transform 0.3s, opacity 0.3s;
}

footer .social-links a:hover {
  transform: scale(1.2);
  opacity: 0.7;
}

footer p {
  font-size: 14px;
  opacity: 0.7;
  margin: 0;
}
.attention-line {
  display: flex;
  align-items: center;
  text-align: center;
  margin: 30px 0;
  font-weight: bold;
  color: black;
  font-size: 18px;
  position: relative;
}

.attention-line::before,
.attention-line::after {
  content: '';
  flex: 1;
  height: 3px;
  background: black;
  margin: 0 15px;
  border-radius: 2px;
}
</style>
</head>
<body>

<header>
  <div class="btn-group">
    <button id="backBtn">–ù–∞–∑–∞–¥</button>
  </div>
  <div class="logo">
    <img src="logo.png" alt="KRIPL Logo">
  </div>
  <div class="btn-group">
    <button onclick="window.location.href='index.html'">–ì–æ–ª–æ–≤–Ω–∞</button>
  </div>
</header>

<main>
  <div class="cart-container" id="cart"></div>
  <div class="total" id="total">–°—É–º–∞: 0 –≥—Ä–Ω</div>
  <button class="checkout-btn" onclick="openModal()" id="checkoutBtn" disabled>–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
</main>

<div class="modal" id="checkoutModal">
  <div class="modal-content">
    <span class="close-modal" onclick="closeModal()">√ó</span>
    <h2 id="modalTitle">–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h2>
    <input type="text" id="name" placeholder="–Ü–º'—è">
    <input type="text" id="surname" placeholder="–ü—Ä—ñ–∑–≤–∏—â–µ">
    <input type="tel" id="phone" placeholder="–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É">
    <input type="text" id="social" placeholder="Telegram/Instagram (–Ω–µ –æ–±–æ–≤—è–∑–∫–æ–≤–æ)">
    <button onclick="submitOrder()" id="sendBtn">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
  </div>
</div>

<!-- Footer -->
<footer>
  <div class="social-links">
    <a href="https://www.instagram.com/kripl.ua/" target="_blank" aria-label="Instagram">
      <i class="fa-brands fa-instagram fa-2x"></i>
    </a>
    <a href="https://t.me/+T1SHP7_Zel1hZDQ6" target="_blank" aria-label="Telegram">
      <i class="fa-brands fa-telegram fa-2x"></i>
    </a>
    <a href="https://www.tiktok.com/@.kripl" target="_blank" aria-label="TikTok">
      <i class="fa-brands fa-tiktok fa-2x"></i>
    </a>
  </div>
  <p>¬© 2025 KRIPL</p>
</footer>
<div class="order-note">
	   <div class="attention-line">
  <span>‚Üì–£–í–ê–ì–ê‚Üì</span>
</div>
  <p> –û–ø–ª–∞—Ç—É –Ω–∞ —Å–∞–π—Ç—ñ –Ω–µ –ø—Ä–∏–π–º–∞—î–º–æ —É –∑–≤ º—è–∑–∫—É –∑ —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—ñ—Å—Ç—é –Ω–∞—à–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç—É, –∑–∞–ª–∏—à–∞–π—Ç–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ –∫–æ—à–∏–∫ —ñ –º–∏ –∑ –≤–∞–º–∏ –∑–≤ º—è–∂–µ–º–æ—Å—è, –∞–±–æ –ø–∏—à—ñ—Ç—å —É –Ω–∞—à—ñ –æ—Ñ—ñ—Ü—ñ–π–Ω—ñ —Å–æ—Ü—ñ–∞–ª—å–Ω—ñ –º–µ—Ä–µ–∂—ñ —è–∫—ñ –≤–∫–∞–∑–∞–Ω—ñ –Ω–∏–∂—á–µ.</p>
  <p>We do not accept payment on the website due to the individuality of our product, place an order through the cart and we will contact you, or write to our official social networks listed below.</p>
</div>

<script>
// --- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ ---
if(document.referrer){
    sessionStorage.setItem('previousPage', document.referrer);
}

document.getElementById('backBtn').addEventListener('click', ()=>{
    const prevPage = sessionStorage.getItem('previousPage') || 'index.html';'caps.html';'cap1.html';'cap2.html';
    window.location.href = prevPage;
});

// --- –ö–æ—à–∏–∫ ---
const cartContainer = document.getElementById('cart');
const checkoutBtn = document.getElementById('checkoutBtn');

function saveCart(){ localStorage.setItem('cart', JSON.stringify(cartItems)); }
function loadCart(){ 
    let stored = JSON.parse(localStorage.getItem('cart') || '[]');
    return stored.map(item=>({
        ...item,
        price: isNaN(parseFloat(item.price)) ? 0 : parseFloat(item.price),
        quantity: isNaN(parseInt(item.quantity)) ? 1 : parseInt(item.quantity)
    }));
}

let cartItems = loadCart();

function renderCart() {
    cartContainer.innerHTML = '';
    if(cartItems.length === 0){
        cartContainer.innerHTML = `<p>–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π</p>`;
        checkoutBtn.disabled = true;
        updateTotal();
        return;
    }
    cartItems.forEach((item, index)=>{
        const div = document.createElement('div');
        div.className = 'cart-item';
        div.innerHTML = `
            <img src="${item.img}" alt="–¢–æ–≤–∞—Ä">
            <div class="cart-item-details">
                <p class="item-title">${item.title}</p>
                <p class="item-color">${item.color}</p>
                <p class="item-size">${item.size}</p>
                <p class="cart-item-price">${item.price} ‚Ç¥</p>
            </div>
            <input type="number" class="cart-item-quantity" value="${item.quantity}" min="1" onchange="changeQuantity(${index}, this.value)">
            <button class="delete-btn" onclick="removeItem(${index})">–í–∏–¥–∞–ª–∏—Ç–∏</button>
        `;
        cartContainer.appendChild(div);
    });
    checkoutBtn.disabled = false;
    updateTotal();
}
function addToCart(item){
    item.price = parseFloat(item.price) || 0;
    item.quantity = parseInt(item.quantity) || 1;
    cartItems.push(item);
    saveCart();
    renderCart();
}

function removeItem(index){
    const itemDiv = cartContainer.children[index];
    itemDiv.style.animation = 'fadeOut 0.3s forwards';
    setTimeout(()=>{
        cartItems.splice(index,1);
        saveCart();
        renderCart();
    },300);
}

function changeQuantity(index, value){
    cartItems[index].quantity = parseInt(value) || 1;
    saveCart();
    updateTotal();
}

function updateTotal(){
    let total = cartItems.reduce((sum,item)=>{
        let price = parseFloat(item.price) || 0;
        let quantity = parseInt(item.quantity) || 1;
        return sum + (price * quantity);
    },0);
    document.getElementById('total').textContent = `–°—É–º–∞: ${total} ‚Ç¥`;
}

function openModal(){ 
    if(cartItems.length>0) document.getElementById('checkoutModal').style.display='flex'; 
}

function closeModal(){ 
    document.getElementById('checkoutModal').style.display='none'; 
}
function submitOrder(){
    if(cartItems.length === 0){
        alert('–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π!');
        return;
    }

    const name = document.getElementById('name').value.trim();
    const surname = document.getElementById('surname').value.trim();
    const phone = document.getElementById('phone').value.trim();
    const social = document.getElementById('social').value.trim();

    if(!name || !surname || !phone){
        alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –æ–±–æ–≤\'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è');
        return;
    }

    // –ü–æ–∫–∞–∑—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
    const sendBtn = document.getElementById('sendBtn');
    const originalText = sendBtn.textContent;
    sendBtn.textContent = '–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ...';
    sendBtn.disabled = true;

    // –ì–æ—Ç—É—î–º–æ –¥–∞–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
    const orderData = prepareOrderData(name, surname, phone, social);
    
    // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –≤ Telegram
    sendToTelegram(orderData)
        .then(() => {
            alert('‚úÖ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ! –ú–∏ –∑ –≤–∞–º–∏ –∑–≤\'—è–∂–µ–º–æ—Å—å –ø—Ä–æ—Ç—è–≥–æ–º 15 —Ö–≤–∏–ª–∏–Ω.');
            clearCartAndForm();
        })
        .catch(error => {
            console.error('–ü–æ–º–∏–ª–∫–∞:', error);
            alert('‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑ –∞–±–æ –∑–≤\'—è–∂—ñ—Ç—å—Å—è –∑ –Ω–∞–º–∏ –Ω–∞–ø—Ä—è–º—É —á–µ—Ä–µ–∑ Instagram.');
        })
        .finally(() => {
            sendBtn.textContent = originalText;
            sendBtn.disabled = false;
        });
}

function prepareOrderData(name, surname, phone, social) {
    const mappedCart = cartItems.map(item => ({
        name: item.title || '–ë–µ–∑ –Ω–∞–∑–≤–∏',
        color: item.color || '–ù–µ –≤–∫–∞–∑–∞–Ω–æ',
        size: item.size || '–ù–µ –≤–∫–∞–∑–∞–Ω–æ',
        price: parseFloat(item.price) || 0,
        quantity: parseInt(item.quantity) || 1
    }));

    const total = mappedCart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    const orderId = 'ORDER_' + Date.now().toString().slice(-6);
    
    return {
        id: orderId,
        firstName: name,
        lastName: surname,
        phone: phone,
        username: social,
        cart: mappedCart,
        total: total,
        date: new Date().toLocaleString('uk-UA')
    };
}

async function sendToTelegram(order) {
    // üîß –î–í–û–Ñ –ê–î–ú–Ü–ù–Ü–í - –∑–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ñ chat_id
    const ADMIN_CHAT_IDS = [
        '868464115',    // –ü–µ—Ä—à–∏–π –∞–¥–º—ñ–Ω (–∑–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ –≤–∞—à chat_id)
        '580852151'     // –î—Ä—É–≥–∏–π –∞–¥–º—ñ–Ω (–∑–∞–º—ñ–Ω—ñ—Ç—å –Ω–∞ chat_id –¥—Ä—É–≥–æ–≥–æ –∞–¥–º—ñ–Ω–∞)
    ];
    
    const BOT_TOKEN = '7600309533:AAGW10Bjm4Br4ma8HEWxcvYmdJCz4pwrelE'; // –í–∞—à —Ç–æ–∫–µ–Ω
    
    // –§–æ—Ä–º—É—î–º–æ –∫—Ä–∞—Å–∏–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è Telegram
    let message = `üõçÔ∏è <b>–ù–û–í–ï –ó–ê–ú–û–í–õ–ï–ù–ù–Ø</b>\n`;
    message += `üì¶ <b>‚Ññ${order.id}</b>\n\n`;
    message += `üë§ <b>–ö–ª—ñ—î–Ω—Ç:</b> ${order.firstName} ${order.lastName}\n`;
    message += `üìû <b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> <code>${order.phone}</code>\n`;
    message += `üí¨ <b>–°–æ—Ü–º–µ—Ä–µ–∂–∞:</b> ${order.username || '–ù–µ –≤–∫–∞–∑–∞–Ω–æ'}\n`;
    message += `üìÖ <b>–î–∞—Ç–∞:</b> ${order.date}\n\n`;
    message += `üõí <b>–¢–æ–≤–∞—Ä–∏:</b>\n`;
    
    order.cart.forEach((item, index) => {
        const itemTotal = item.quantity * item.price;
        message += `\n${index + 1}. <b>${item.name}</b>\n`;
        message += `   üé® –ö–æ–ª—ñ—Ä: ${item.color}\n`;
        message += `   üìè –†–æ–∑–º—ñ—Ä: ${item.size}\n`;
        message += `   üì¶ –ö—ñ–ª—å–∫—ñ—Å—Ç—å: ${item.quantity} √ó ${item.price}‚Ç¥ = ${itemTotal}‚Ç¥\n`;
    });
    
    message += `\nüí∞ <b>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞:</b> ${order.total}‚Ç¥\n`;
    message += `‚è∞ <b>–ß–∞—Å –æ—Ç—Ä–∏–º–∞–Ω–Ω—è:</b> ${new Date().toLocaleTimeString('uk-UA')}`;
    
    // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –û–ë–û–ú –∞–¥–º—ñ–Ω–∞–º
    const sendPromises = ADMIN_CHAT_IDS.map(chatId => {
        return fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                chat_id: chatId,
                text: message,
                parse_mode: 'HTML'
            })
        });
    });
    
    // –ß–µ–∫–∞—î–º–æ –ø–æ–∫–∏ –æ–±–æ–º –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å—Å—è
    const results = await Promise.all(sendPromises);
    
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —Ö–æ—á–∞ –± –æ–¥–∏–Ω —É—Å–ø—ñ—à–Ω–∏–π
    const atLeastOneSuccess = results.some(response => response.ok);
    
    if (!atLeastOneSuccess) {
        throw new Error('–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∂–æ–¥–Ω–æ–º—É –∞–¥–º—ñ–Ω—É');
    }
    
    console.log(`‚úÖ –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ ${results.filter(r => r.ok).length}/2 –∞–¥–º—ñ–Ω–∞–º`);
    return results;
}

function clearCartAndForm() {
    cartItems = [];
    saveCart();
    renderCart();
    closeModal();
    
    document.getElementById('name').value = '';
    document.getElementById('surname').value = '';
    document.getElementById('phone').value = '';
    document.getElementById('social').value = '';
}

renderCart();
</script>

</body>
</html>
